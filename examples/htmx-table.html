<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Simple HTMX Table</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="../styles/table.css" />
    <script
      src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.8/dist/htmx.min.js"
      integrity="sha384-/TgkGk7p307TH7EXJDuUlgG3Ce1UVolAOFopFekQkkXihi5u/6OCvVKyz1W+idaz"
      crossorigin="anonymous"
    ></script>
    <script src="https://unpkg.com/hyperscript.org@0.9.14"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <style>
      .htx-columns-item {
        padding: 8px 10px;
        margin-bottom: 5px;
        background: #f8f9fa;
        border: 1px solid #ddd;
        border-radius: 4px;
        display: flex;
        align-items: center;
      }
      .htx-sortable-ghost {
        background: #e9ecef;
        opacity: 0.5;
      }
    </style>
  </head>
  <body class="p-5">
    <div
      id="table-header"
      class="mb-4"
      hx-get="/table-header"
      hx-trigger="load"
      hx-swap="innerHTML"
    >
      <!-- Content loaded from server based on settings -->
    </div>

    <div
      id="table-container"
      hx-get="/table-data"
      hx-trigger="load"
      hx-target="this"
      hx-swap="innerHTML"
    >
      <p>Loading data...</p>
    </div>

    <div
      id="table-footer"
      class="mt-4 d-flex align-items-center justify-content-between"
    >
      <div id="table-pagination"></div>

      <div
        id="per-page-control"
        hx-get="/table-settings"
        hx-trigger="load"
        hx-swap="outerHTML"
      ></div>
    </div>

    <script>
      htmx.onLoad(function (content) {
        var sortables = content.querySelectorAll(".sortable");

        for (var i = 0; i < sortables.length; i++) {
          var sortable = sortables[i];

          new Sortable(sortable, {
            animation: 150,

            ghostClass: "htx-sortable-ghost",

            handle: ".htx-drag-handle",
          });
        }
      });
    </script>
  </body>
</html>
